fixed issues with switching windows