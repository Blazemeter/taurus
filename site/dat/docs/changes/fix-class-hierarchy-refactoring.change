restructure class inheritance. move some dependencies up the class hierarchy.
