- optimize aggregator by using single-pass iterator